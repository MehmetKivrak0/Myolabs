<!DOCTYPE html>
<html lang="tr">

<!-- Mirrored from xrlab.cbu.edu.tr/lab/pages/lab9.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 23 Aug 2025 09:17:11 GMT -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Genişletilmiş Gerçeklik Laboratuvarı Detayları - MCBÜ">
    <title>Genişletilmiş Gerçeklik Laboratuvarı - MCBÜ</title>

    <link rel="stylesheet" href="../styles/variables.css">
    <link rel="stylesheet" href="../styles/base.css">
    <link rel="stylesheet" href="../styles/components/navbar.html">
    <link rel="stylesheet" href="../styles/components/cards.css">
    <link rel="stylesheet" href="../styles/components/buttons.css">
    <link rel="stylesheet" href="../styles/components/footer.css">
    <link rel="stylesheet" href="../styles/components/lab-details.css">
    <link rel="stylesheet" href="../styles/utilities.css">
    <link rel="stylesheet" href="../styles/responsive.css">
    <link rel="stylesheet" href="../styles/components/hero.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Hero Section -->
    <header class="hero">
        <div class="hero-content">
            <img src="../images/myo.png" alt="MCBÜ Logo" class="myo-logo">   
        </div>
        
        <!-- Back to Catalog Button -->
        <div class="back-button-container">
            <a href="../../myokatalog/index.html" class="back-to-catalog-btn">
                <i class="fas fa-arrow-left"></i>
                <span>Kataloğa Geri Dön</span>
            </a>
        </div>
    </header>
    
        <main class="container">
            <div class="lab-details">
                <!-- Loading state -->
                <div id="lab-loading" class="lab-loading">
                    <div class="spinner"></div>
                    <p>Laboratuvar bilgileri yükleniyor...</p>
                </div>
                
                <!-- Lab content (will be populated dynamically) -->
                <div id="lab-content" style="display: none;">
                    <img id="lab-main-image" src="" alt="Laboratuvar Ana Resmi" class="lab-main-image">
                    <div class="lab-info">
                        <h1 id="lab-title">Laboratuvar Başlığı</h1>
                        
                        <div class="lab-features">
                            <h2 id="lab-about-title">Laboratuvar Hakkında</h2>
                            <p id="lab-about">Laboratuvar bilgileri yükleniyor...</p>
                            <div id="content-info" style="margin-top: 10px; font-size: 12px; color: #888; font-style: italic;"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Error state -->
                <div id="lab-error" class="lab-error" style="display: none;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <h2>Laboratuvar Bulunamadı</h2>
                    <p>Belirtilen laboratuvar bulunamadı veya yüklenemedi.</p>
                    <a href="../../myokatalog/index.html" class="btn back-to-catalog-btn">
                        <i class="fas fa-arrow-left"></i>
                        Kataloğa Geri Dön
                    </a>
                </div>
            </div>

                <!-- Devices section -->
                <div class="devices-section">
                    <h2>Laboratuvar Cihazları</h2>
                    
                    <!-- Loading state for devices -->
                    <div id="devices-loading" class="devices-loading">
                        <div class="spinner"></div>
                        <p>Cihazlar yükleniyor...</p>
                    </div>
                    
                                        <!-- Devices grid (will be populated dynamically) -->
                    <div id="devices-grid" class="devices-grid" style="display: none;">
                        <!-- Devices will be loaded here -->
                    </div>
                    
                    <!-- Pagination -->
                    <div id="pagination" class="pagination" style="display: none;">
                        <button id="prev-page" class="pagination-btn" onclick="changePage(-1)">
                            <i class="fas fa-chevron-left"></i> Önceki
                        </button>
                        <div id="page-numbers" class="page-numbers">
                            <!-- Page numbers will be generated here -->
                        </div>
                        <button id="next-page" class="pagination-btn" onclick="changePage(1)">
                            Sonraki <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                    
                    <!-- No devices state -->
                    <div id="no-devices" class="no-devices" style="display: none;">
                        <i class="fas fa-microchip"></i>
                        <p>Bu laboratuvarda henüz cihaz bulunmamaktadır</p>
                        <small>Dashboard'dan cihaz ekleyebilirsiniz</small>
                    </div>
                </div>
            </div>
        </main>

    <footer>
        <div class="footer-contact">
            <div class="footer-info">
                <a href="https://xrlab.mcbu.edu.tr/" 
                   target="_blank" 
                   aria-label="XRlab sitesini ziyaret et">
                    <img src="../images/xr.png" alt="XRlab" width="100" height="100" />
                </a>
                <p class="footer-title">Copyright © 2025. MCBU Extended Reality Lab. All Rights Reserved.</p>
                <p class="footer-title">Tasarım ve Kodlama</p>
            </div>
            <div class="footer-name-container">  
                <p class="footer-name">Görkem Taha Çanakcı</p>
                <div class="footer-social">
                    <a href="mailto:gorkemtaha1000@gmail.com" 
                       target="_blank" 
                       aria-label="Gmail adresimi ziyaret et">
                        <img src="../images/gm.png" alt="Gmail" width="28" height="28" />
                    </a>
                    <a href="https://www.linkedin.com/in/görkem-taha-ç-31521028a/" 
                       target="_blank" 
                       aria-label="LinkedIn profilimi ziyaret et">
                        <img src="../images/li.png" alt="LinkedIn" width="28" height="28" />
                    </a>
                    <a href="https://github.com/Gorkem-Taha" 
                       target="_blank" 
                       aria-label="GitHub profilimi ziyaret et">
                        <img src="../images/github.png" alt="GitHub" width="28" height="28" />
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Sayfa yüklendiğinde laboratuvar bilgilerini yükle
        document.addEventListener('DOMContentLoaded', function() {
            loadLabDetails();
        });

        // URL'den laboratuvar ID'sini al
        function getLabIdFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('id');
        }

        // Laboratuvar detaylarını yükle
        async function loadLabDetails() {
            const labId = getLabIdFromUrl();
            
            console.log('🔍 Laboratuvar ID:', labId);
            
            if (!labId) {
                showLabError('Laboratuvar ID bulunamadı');
                return;
            }

            try {
                console.log('📡 API çağrıları başlıyor...');
                
                // Laboratuvar içeriğini yükle
                const contentUrl = `../../Dasboard/api_lab_contents.php?lab_id=${labId}`;
                console.log('📋 İçerik API URL:', contentUrl);
                
                const contentResponse = await fetch(contentUrl);
                console.log('📋 İçerik API Response Status:', contentResponse.status);
                
                if (!contentResponse.ok) {
                    console.log('❌ İçerik API HTTP hatası:', contentResponse.status, contentResponse.statusText);
                }
                
                const contentData = await contentResponse.json();
                console.log('📋 İçerik API Data:', contentData);
                console.log('📋 İçerik API Success:', contentData.success);
                console.log('📋 İçerik API Data içeriği:', contentData.data);
                console.log('📋 İçerik API Data tipi:', typeof contentData.data);
                console.log('📋 İçerik API Data keys:', contentData.data ? Object.keys(contentData.data) : 'null');
                
                // Laboratuvar bilgilerini yükle
                const labUrl = `../../Dasboard/api_laboratories.php?action=get_by_id&id=${labId}`;
                console.log('🏗️ Laboratuvar API URL:', labUrl);
                
                const labResponse = await fetch(labUrl);
                console.log('🏗️ Laboratuvar API Response Status:', labResponse.status);
                
                const labData = await labResponse.json();
                console.log('🏗️ Laboratuvar API Data:', labData);
                
                if (contentData.success || labData.success) {
                    console.log('✅ Veri başarıyla yüklendi');
                    console.log('📋 Content Data:', contentData);
                    console.log('🏗️ Lab Data:', labData);
                    
                    // API'den gelen veri yapısını kontrol et
                    const contents = contentData.success ? contentData.data : null;
                    const labInfo = labData.success ? labData.data : null;
                    
                    console.log('📋 Contents (processed):', contents);
                    console.log('🏗️ Lab Info (processed):', labInfo);
                    
                    displayLabContent(contents, labInfo);
                    // Cihazları da yükle
                    loadLabDevices(labId);
                } else {
                    console.log('❌ API başarısız:', { contentData, labData });
                    showLabError('Laboratuvar bilgileri yüklenemedi');
                }
            } catch (error) {
                console.error('💥 Laboratuvar yüklenirken hata:', error);
                showLabError('Laboratuvar yüklenirken hata oluştu: ' + error.message);
            }
        }

        // Laboratuvar içeriğini görüntüle
        function displayLabContent(contents, labInfo) {
            const loadingDiv = document.getElementById('lab-loading');
            const contentDiv = document.getElementById('lab-content');
            const errorDiv = document.getElementById('lab-error');
            
            console.log('🔍 displayLabContent çağrıldı');
            console.log('🔍 contents parametresi:', contents);
            console.log('🔍 labInfo parametresi:', labInfo);
            
            // Loading'i gizle
            loadingDiv.style.display = 'none';
            
            if (!contents && !labInfo) {
                console.log('❌ Hem contents hem de labInfo boş, hata gösteriliyor');
                errorDiv.style.display = 'block';
                return;
            }
            
            // İçeriği göster
            contentDiv.style.display = 'block';
            
            // Başlık güncelle
            if (contents && contents.lab_title) {
                console.log('✅ Lab title bulundu:', contents.lab_title.content_value);
                document.getElementById('lab-title').textContent = contents.lab_title.content_value;
            } else if (labInfo) {
                console.log('✅ Lab info name kullanılıyor:', labInfo.name);
                document.getElementById('lab-title').textContent = labInfo.name;
            }
            
            // Hakkında metni güncelle
            const labAboutElement = document.getElementById('lab-about');
            
            if (contents && labAboutElement) {
                // Önce detail_page_info'yu kontrol et
                if (contents.detail_page_info && contents.detail_page_info.content_value) {
                    labAboutElement.textContent = contents.detail_page_info.content_value;
                    console.log('✅ Detay sayfası bilgisi yüklendi');
                } else if (contents.catalog_info && contents.catalog_info.content_value) {
                    labAboutElement.textContent = contents.catalog_info.content_value;
                    console.log('✅ Katalog bilgisi yüklendi');
                } else if (contents.lab_title && contents.lab_title.content_value) {
                    labAboutElement.textContent = contents.lab_title.content_value;
                    console.log('✅ Laboratuvar başlığı yüklendi');
                } else {
                    labAboutElement.textContent = 'Bu laboratuvar hakkında detaylı bilgi bulunmamaktadır.';
                    console.log('❌ Metin bulunamadı, varsayılan metin gösteriliyor');
                }
            } else {
                console.log('❌ Dashboard\'dan metin bulunamadı, varsayılan metin gösteriliyor');
                if (labAboutElement) {
                    labAboutElement.textContent = 'Bu laboratuvar hakkında detaylı bilgi bulunmamaktadır. Dashboard\'dan metin ekleyebilirsiniz.';
                    console.log('✅ lab-about varsayılan metinle güncellendi');
                } else {
                    console.log('❌ lab-about elementi bulunamadı!');
                }
            }
            
            // Ana resim güncelle
            if (contents && contents.main_image) {
                document.getElementById('lab-main-image').src = `../../${contents.main_image.content_value}`;
                document.getElementById('lab-main-image').alt = document.getElementById('lab-title').textContent;
            } else {
                // Varsayılan resim göster
                document.getElementById('lab-main-image').src = '../../image/logo/nophoto.jpg';
                document.getElementById('lab-main-image').alt = 'Laboratuvar Varsayılan Resmi';
            }
        }

        // Laboratuvar cihazlarını yükle
        async function loadLabDevices(labId) {
            try {
                console.log('🔧 Cihazlar yükleniyor, Lab ID:', labId);
                
                const deviceUrl = `../../Dasboard/api_devices.php?action=get_by_lab&lab_id=${labId}`;
                console.log('🔧 Cihaz API URL:', deviceUrl);
                
                const response = await fetch(deviceUrl);
                console.log('🔧 Cihaz API Response Status:', response.status);
                
                const data = await response.json();
                console.log('🔧 Cihaz API Data:', data);
                
                if (data.success) {
                    console.log('✅ Cihazlar başarıyla yüklendi:', data.devices);
                    displayDevices(data.devices);
                } else {
                    console.log('❌ Cihaz API başarısız:', data);
                    showNoDevices();
                }
            } catch (error) {
                console.error('💥 Cihazlar yüklenirken hata:', error);
                showNoDevices();
            }
        }

        // Global değişkenler
        let allDevices = [];
        let currentPage = 1;
        const devicesPerPage = 8; // Bir sayfada 8 card

        // Cihazları görüntüle
        function displayDevices(devices) {
            const loadingDiv = document.getElementById('devices-loading');
            const gridDiv = document.getElementById('devices-grid');
            const noDevicesDiv = document.getElementById('no-devices');
            const paginationDiv = document.getElementById('pagination');
            
            // Loading'i gizle
            loadingDiv.style.display = 'none';
            
            if (!devices || devices.length === 0) {
                showNoDevices();
                return;
            }
            
            // Tüm cihazları global değişkende sakla
            allDevices = devices;
            currentPage = 1;
            
            // İlk sayfayı göster
            displayCurrentPage();
            
            // Sayfalamayı göster
            paginationDiv.style.display = 'flex';
        }

        // Mevcut sayfayı göster
        function displayCurrentPage() {
            const gridDiv = document.getElementById('devices-grid');
            const startIndex = (currentPage - 1) * devicesPerPage;
            const endIndex = startIndex + devicesPerPage;
            const currentDevices = allDevices.slice(startIndex, endIndex);
            
            // Cihazları göster
            gridDiv.style.display = 'grid';
            
            let html = '';
            currentDevices.forEach((device, index) => {
                html += `
                    <div class="device-container">
                        <div class="device-photo">
                            ${device.image_url ? 
                                `<img src="../../${device.image_url}" alt="${device.device_name}">` :
                                `<img src="../../image/logo/nophoto.jpg" alt="${device.device_name} - Varsayılan Resim">`
                            }
                        </div>
                        <div class="device-info">
                            <div class="device-name">
                                <h2>Cihaz Adı/Modeli</h2>
                                <h4>${device.device_name}</h4>
                                ${device.device_model ? `<small>${device.device_model}</small>` : ''}
                            </div>
                            <div class="device-count">
                                <h2>Sayısı</h2>
                                <h4>${device.device_count}</h4>
                            </div>
                        </div>
                        <div class="device-purpose">
                            <h2>Kullanım Amacı</h2>
                            <h4>${device.purpose || 'Belirtilmemiş'}</h4>
                        </div>
                    </div>
                `;
            });
            
            gridDiv.innerHTML = html;
            
            // Sayfa numaralarını güncelle
            updatePagination();
        }

        // Sayfa değiştir
        function changePage(direction) {
            const totalPages = Math.ceil(allDevices.length / devicesPerPage);
            
            if (direction === -1 && currentPage > 1) {
                currentPage--;
            } else if (direction === 1 && currentPage < totalPages) {
                currentPage++;
            }
            
            displayCurrentPage();
        }

        // Belirli sayfaya git
        function goToPage(pageNumber) {
            const totalPages = Math.ceil(allDevices.length / devicesPerPage);
            if (pageNumber >= 1 && pageNumber <= totalPages) {
                currentPage = pageNumber;
                displayCurrentPage();
            }
        }

        // Sayfalama numaralarını güncelle
        function updatePagination() {
            const totalPages = Math.ceil(allDevices.length / devicesPerPage);
            const pageNumbersDiv = document.getElementById('page-numbers');
            const prevBtn = document.getElementById('prev-page');
            const nextBtn = document.getElementById('next-page');
            
            // Önceki/Sonraki butonlarını güncelle
            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
            
            // Sayfa numaralarını oluştur
            let pageNumbersHtml = '';
            for (let i = 1; i <= totalPages; i++) {
                const isActive = i === currentPage;
                pageNumbersHtml += `
                    <button class="page-number ${isActive ? 'active' : ''}" 
                            onclick="goToPage(${i})">
                        ${i}
                    </button>
                `;
            }
            
            pageNumbersDiv.innerHTML = pageNumbersHtml;
        }

        // Cihaz yok durumunu göster
        function showNoDevices() {
            document.getElementById('devices-loading').style.display = 'none';
            document.getElementById('devices-grid').style.display = 'none';
            document.getElementById('no-devices').style.display = 'block';
        }

        // Laboratuvar hatası göster
        function showLabError(message) {
            document.getElementById('lab-loading').style.display = 'none';
            document.getElementById('lab-content').style.display = 'none';
            document.getElementById('lab-error').style.display = 'block';
            
            const errorDiv = document.getElementById('lab-error');
            errorDiv.querySelector('p').textContent = message;
        }
    </script>
</body>

<!-- Mirrored from xrlab.cbu.edu.tr/lab/pages/lab9.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 23 Aug 2025 09:17:17 GMT -->
</html>
